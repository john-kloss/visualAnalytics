bdrms
hprice <- read.csv(str_c(dirname(getwd()), "/visualAnalytics/Data/hprice.csv"))
fit <- hprice %>%
lm(price ~ bdrms, data=.)
summary(fit)
fit <- hprice %>%
lm(price ~ lotsize, data=.)
summary(fit)
fit <- hprice %>%
lm(price ~ sqrm, data=.)
summary(fit)
fit <- hprice %>%
lm(price ~ country, data=.)
summary(fit)
summary(fit)$r.squared
hprice <- read.csv(str_c(dirname(getwd()), "/visualAnalytics/Data/hprice.csv"))
fit <- hprice %>%
lm(price ~ bdrms, data=.)
summary(fit)$r.squared
fit <- hprice %>%
lm(price ~ lotsize, data=.)
summary(fit)$r.squared
fit <- hprice %>%
lm(price ~ sqrm, data=.)
summary(fit)$r.squared
fit <- hprice %>%
lm(price ~ country, data=.)
summary(fit)$r.squared
summary(fit)$r.squared
hprice <- read.csv(str_c(dirname(getwd()), "/visualAnalytics/Data/hprice.csv"))
fit <- hprice %>%
lm(price ~ bdrms, data=.)
summary(fit)$r.squared
summary(fit)$coef
fit <- hprice %>%
lm(price ~ lotsize, data=.)
summary(fit)$r.squared
summary(fit)$coef
fit <- hprice %>%
lm(price ~ sqrm, data=.)
summary(fit)$r.squared
summary(fit)$coef
fit <- hprice %>%
lm(price ~ country, data=.)
summary(fit)$r.squared
summary(fit)$coef
hprice <- read.csv(str_c(dirname(getwd()), "/visualAnalytics/Data/hprice.csv"))
fit <- hprice %>%
lm(price ~ bdrms, data=.)
summary(fit)$r.squared
summary(fit)$coef
fit <- hprice %>%
lm(price ~ lotsize, data=.)
summary(fit)$r.squared
summary(fit)$coef
fit <- hprice %>%
lm(price ~ sqrm, data=.)
summary(fit)$r.squared
summary(fit)$coef
fit <- hprice %>%
lm(price ~ country, data=.)
summary(fit)$r.squared
summary(fit)$coef
install.packages("car")
knitr::opts_chunk$set(echo = TRUE,
eval = TRUE,
warning = FALSE,
message = FALSE)
library(dplyr)
library(ggplot2)
library(stringr)
library(car)
vif(lm(price ~ bdrms + lotsize + sqrm + country, data=hprice))
ggplot(aes(pice, bdrms))
ggplot(pice, bdrms)
hprice %>%
ggplot(aes(pice, bdrms))
hprice %>%
ggplot(aes(pice, bdrms))
hprice %>%
ggplot(aes(price, bdrms))
hprice %>%
ggplot(aes(price, bdrms))+
geom_point(color="grey")
hprice %>%
ggplot(aes(price, bdrms))+
geom_point(color="black")
ggplot(hprice) +
stat_qq(aes(sample = scale(R))) +
geom_abline(intercept = 0, slope = 1)
ggplot(hprice) +
geom_abline(intercept = 0, slope = 1)
ggplot(hprice) +
stat_qq(hprice) +
geom_abline(intercept = 0, slope = 1)
ggplot(hprice) +
stat_qq(aes(hprice)) +
geom_abline(intercept = 0, slope = 1)
ggplot(hprice) +
stat_qq(aes(sample =hprice)) +
geom_abline(intercept = 0, slope = 1)
ggplot(hprice) +
stat_qq(aes(sample = scale(hprice))) +
geom_abline(intercept = 0, slope = 1)
scale(hprice)
stat_qq(aes(sample = scale(hprice))) +
geom_abline(intercept = 0, slope = 1)
hprice
ggplot(hprice) +
stat_qq(aes(sample = scale(hprice))) +
geom_abline(intercept = 0, slope = 1)
hprice %>%
ggplot(aes(price, bdrms))+
geom_point(color="black")
r <- cor(father.son$fheight, father.son$sheight)
ggplot(dnorm(88,mean=0, sd=1)) +
stat_qq(aes(sample = scale(hprice))) +
geom_abline(intercept = 0, slope = 1)
?rt
rnorm(88, mean=0, sd=1)
ggplot(rnorm(88, mean=0, sd=1)) +
stat_qq(aes(sample = scale(hprice))) +
geom_abline(intercept = 0, slope = 1)
ggplot(hprice) +
stat_qq(aes(sample = rnorm(88, mean=0, sd=1))) +
geom_abline(intercept = 0, slope = 1)
ggplot(hprice) +
stat_qq(aes(sample = rnorm(2, mean=0, sd=1))) +
geom_abline(intercept = 0, slope = 1)
88
ggplot(hprice) +
stat_qq(aes(sample = rnorm(88, mean=0, sd=1))) +
geom_abline(intercept = 0, slope = 1)
ggplot() +
stat_qq(aes(sample = rnorm(88, mean=0, sd=1))) +
geom_abline(intercept = 0, slope = 1)
ggplot() +
stat_qq(aes(sample = scale(hprice))) +
geom_abline(intercept = 0, slope = 1)
ggplot() +
stat_qq(aes(sample = scale(hprice)))
ggplot() +
stat_qq(aes(sample = scale(hprice)))
ggplot() +
qqnorm(hprice)
qqnorm(hprice)
qqnorm(price)
qqnorm(hprice$price)
qqnorm(hprice$price)+
geom_abline(intercept = 0, slope = 1)
ggplot()+
qqnorm(hprice$price)+
geom_abline(intercept = 0, slope = 1)
qqnorm(hprice$price)
hprice %>%
ggplot(aes(price, bdrms))+
geom_point(color="black")
qqnorm(hprice$price)
qqnorm(hprice$bdrms)
qqnorm(hprice$lotsize)
qqnorm(hprice$sqrm)
qqnorm(hprice$country)
qqnorm(hprice$price, main="h")
hprice %>%
ggplot(aes(price, bdrms))+
geom_point(color="black")
qqnorm(hprice$price, main="price")
qqnorm(hprice$bdrms, main="bdrms")
qqnorm(hprice$lotsize, main="lotsize")
qqnorm(hprice$sqrm, main="sqrm")
qqnorm(hprice$country, main="country")
install.packages("modelr")
knitr::opts_chunk$set(echo = TRUE,
eval = TRUE,
warning = FALSE,
message = FALSE)
library(dplyr)
library(ggplot2)
library(stringr)
library(car)
library(modelr)
hprice %>%
add_predictions(fitl) %>%
add_residuals(fitl) %>%
ggplot(aes(pred, resid)) +
geom_point()
hprice <- read.csv(str_c(dirname(getwd()), "/visualAnalytics/Data/hprice.csv"))
fitb <- hprice %>%
lm(price ~ bdrms, data=.)
summary(fit)$r.squared
summary(fit)$coef
fitl <- hprice %>%
lm(price ~ lotsize, data=.)
summary(fit)$r.squared
summary(fit)$coef
fits <- hprice %>%
lm(price ~ sqrm, data=.)
summary(fit)$r.squared
summary(fit)$coef
fitc <- hprice %>%
lm(price ~ country, data=.)
summary(fit)$r.squared
summary(fit)$coef
hprice %>%
add_predictions(fib) %>%
add_residuals(fitb) %>%
ggplot(aes(pred, resid)) +
geom_point()
hprice %>%
add_predictions(fitb) %>%
add_residuals(fitb) %>%
ggplot(aes(pred, resid)) +
geom_point()
fit <- c(fib, fitl, fits, fitc)
fit <- c(fitb, fitl, fits, fitc)
fit
fit
fit[1]
fit[2]
hprice %>%
ggplot(aes(price, bdrms))+
geom_point(color="black")
qqnorm(hprice$price, main="price")
qqnorm(hprice$bdrms, main="bdrms")
qqnorm(hprice$lotsize, main="lotsize")
qqnorm(hprice$sqrm, main="sqrm")
qqnorm(hprice$country, main="country")
hprice %>%
add_predictions(fitb) %>%
add_residuals(fitb) %>%
ggplot(aes(pred, resid)) +
geom_point()
hprice %>%
add_predictions(fitl) %>%
add_residuals(fitl) %>%
ggplot(aes(pred, resid)) +
geom_point()
hprice %>%
add_predictions(fits) %>%
add_residuals(fits) %>%
ggplot(aes(pred, resid)) +
geom_point()
hprice %>%
add_predictions(fitc) %>%
add_residuals(fitc) %>%
ggplot(aes(pred, resid)) +
geom_point()
hprice %>%
add_predictions(fitl) %>%
add_residuals(fitl) %>%
ggplot(aes(pred, resid)) +
geom_point() +
ggtitle("lotsize")
hprice %>%
ggplot(aes(price, bdrms))+
geom_point(color="black")
qqnorm(hprice$price, main="price")
qqnorm(hprice$bdrms, main="bdrms")
qqnorm(hprice$lotsize, main="lotsize")
qqnorm(hprice$sqrm, main="sqrm")
qqnorm(hprice$country, main="country")
hprice %>%
add_predictions(fitb) %>%
add_residuals(fitb) %>%
ggplot(aes(pred, resid)) +
geom_point() +
ggtitle("bdrms")
hprice %>%
add_predictions(fitl) %>%
add_residuals(fitl) %>%
ggplot(aes(pred, resid)) +
geom_point() +
ggtitle("lotsize")
hprice %>%
add_predictions(fits) %>%
add_residuals(fits) %>%
ggplot(aes(pred, resid)) +
geom_point()  +
ggtitle("sqrm")
hprice %>%
add_predictions(fitc) %>%
add_residuals(fitc) %>%
ggplot(aes(pred, resid)) +
geom_point()  +
ggtitle("country")
summary(fit)$r.squared
fit <- hprice %>%
lm(bdrms ~ price, data=.)
hprice %>%
add_predictions(fitb) %>%
add_residuals(fitb) %>%
ggplot(aes(pred, resid)) +
geom_point() +
ggtitle("bdrms")
hprice %>%
add_predictions(fitl) %>%
add_residuals(fitl) %>%
ggplot(aes(pred, resid)) +
geom_point() +
ggtitle("lotsize")
hprice %>%
add_predictions(fits) %>%
add_residuals(fits) %>%
ggplot(aes(pred, resid)) +
geom_point()  +
ggtitle("sqrm")
hprice %>%
add_predictions(fitc) %>%
add_residuals(fitc) %>%
ggplot(aes(pred, resid)) +
geom_point()  +
ggtitle("country")
plot(fitb, which = 4)
plot(fitb, which = 100)
plot(fitl, which = 4)
plot(fitb, which = 4)
plot(fitb, which = 5)
plot(fitb, which = 6)
plot(fitb, which = 5)
plot(fitb, which = 3)
plot(fitb, which = 2)
plot(fitb, which = 1)
plot(fitl, which = 2)
plot(fits, which = 2)
plot(fits, which = 4)
plot(fitl, which = 4)
plot(fits, which = 4)
plot(fitc, which = 4)
plot(fitb, which = 4)
hpric[42]
hprice[42]
hprice[42,]
hprice[41,]
hprice[42,]
hprice[41,]
mean(hprice$price)
hprice[42,]
mean(filter(hprice$price, bdrm=3)
mean(filter(hprice, bdrm=3)$price)
mean(filter(hprice, hprice$bdrm=3)$price)
mean(filter(hprice, hprice$bdrm==3)$price)
hprice[42,]
mean(filter(hprice, hprice$bdrm==3)$price)
hprice[42,]
mean(filter(hprice, hprice$bdrm==5)$price)
hprice[42,]
mean(filter(hprice, hprice$bdrm==5)$price)
plot(fitb, which = 4)
hprice[42,2]
hprice[42,1]
hprice[42,1] - mean(filter(hprice, hprice$bdrm==5)$price)
plot(fitb, which = 4)
hprice[63,]
hprice[42,1] - mean(filter(hprice, hprice$bdrm==hprice[42,2])$price)
plot(fitb, which = 4)
for(i in c(42,63,73)){
hprice[i,1] - mean(filter(hprice, hprice$bdrm==hprice[i,2])$price)
}
for(i in c(42,63,73)){
print hprice[i,1] - mean(filter(hprice, hprice$bdrm==hprice[i,2])$price)
for(i in c(42,63,73)){
d <- hprice[i,1] - mean(filter(hprice, hprice$bdrm==hprice[i,2])$price)
print d
for(i in c(42,63,73)){
d <- hprice[i,1] - mean(filter(hprice, hprice$bdrm==hprice[i,2])$price)
print (d)
}
for(i in c(42,63,73)){
print(hprice[i,1] - mean(filter(hprice, hprice$bdrm==hprice[i,2])$price))
}
for(i in c(42,63,73)){
print(i)
print(hprice[i,1] - mean(filter(hprice, hprice$bdrm==hprice[i,2])$price))
}
for(i in c(42,63,73)){
print("number: "+i)
print(hprice[i,1] - mean(filter(hprice, hprice$bdrm==hprice[i,2])$price))
}
for(i in c(42,63,73)){
print("number: "i)
for(i in c(42,63,73)){
print("number: ",i)
print(hprice[i,1] - mean(filter(hprice, hprice$bdrm==hprice[i,2])$price))
}
for(i in c(42,63,73)){
print("number: ")
print(i)
print(hprice[i,1] - mean(filter(hprice, hprice$bdrm==hprice[i,2])$price))
}
print(number: i)
print("number" i)
print(paste0("number", i)
print(i)
print(paste0("number", i))
print(paste0("number: ", i))
for(i in c(42,63,73)){
print(paste0("number: ", i))
print(hprice[i,1] - mean(filter(hprice, hprice$bdrm==hprice[i,2])$price))
}
plot(fitl, which = 4)
plot(fitl, which = 4)
print(paste0("number: ", 77))
print(hprice[77,1] - mean(filter(hprice, hprice$bdrm==hprice[77,2])$price))
plot(fitb, which = 4)
for(i in c(42,63,73)){
print(paste0("number: ", i))
print(hprice[i,1] - mean(filter(hprice, hprice$bdrm==hprice[i,2])$price))
}
plot(fitl, which = 4)
print(paste0("number: ", 77))
print(hprice[77,1] - mean(filter(hprice, hprice$bdrm==hprice[77,2])$price))
plot(fits, which = 4)
print("bdrms")
plot(fitb, which = 4)
for(i in c(42,63,73)){
print(paste0("number: ", i))
print(hprice[i,1] - mean(filter(hprice, hprice$bdrm==hprice[i,2])$price))
}
print("lotsize")
plot(fitl, which = 4)
print(paste0("number: ", 77))
print(hprice[77,1] - mean(filter(hprice, hprice$lotsize==hprice[77,2])$price))
print("sqrm")
plot(fits, which = 4)
for(i in c(42,48,73)){
print(paste0("number: ", i))
print(hprice[i,1] - mean(filter(hprice, hprice$sqrm==hprice[i,2])$price))
}
print("bdrms")
plot(fitb, which = 4)
for(i in c(42,63,73)){
print(paste0("number: ", i))
print(hprice[i,1] - mean(filter(hprice, hprice$bdrm==hprice[i,2])$price))
}
print("lotsize")
plot(fitl, which = 4)
print(paste0("number: ", 77))
print(hprice[77,1] - mean(filter(hprice, hprice$lotsize==hprice[77,3])$price))
print("sqrm")
plot(fits, which = 4)
for(i in c(42,48,73)){
print(paste0("number: ", i))
print(hprice[i,1] - mean(filter(hprice, hprice$sqrm==hprice[i,4])$price))
}
print(hprice[i,1])
print("bdrms")
plot(fitb, which = 4)
for(i in c(42,63,73)){
print(paste0("number: ", i))
print(hprice[i,1])
}
print("lotsize")
plot(fitl, which = 4)
print(paste0("number: ", 77))
print(hprice[77,1] )
print("sqrm")
plot(fits, which = 4)
for(i in c(42,48,73)){
print(paste0("number: ", i))
print(hprice[i,1] )
}
fitb$residuals
filter(fitb, residuals>100)
where(fitb$residuals, 110)
fitb$residuals
fitb$residuals > 100
fitb$residuals[0]
fitb$residuals[1]
fitb$residuals[2]
for(i in (1:88)){
if(fitb$residuals[i] > 100)
print(i)
}
for(i in (1:88)){
if(fitb$residuals[i] > 100 | fitb$residuals < 100)
print(i)
}
for(i in (1:88)){
if(fitb$residuals[i] > 100 | fitb$residuals < -100)
print(i)
}
for(i in (1:88)){
if(fitb$residuals[i] > 100 | fitb$residuals < -100)
print(i)
if(fitl$residuals[i] > 100 | fitb$residuals < -100)
print(i)
if(fits$residuals[i] > 100 | fitb$residuals < -100)
print(i)
if(fitc$residuals[i] > 100 | fitb$residuals < -100)
print(i)
}
print(paste0("b: ",i))
for(i in (1:88)){
if(fitb$residuals[i] > 100 | fitb$residuals < -100)
print(paste0("b: ",i))
if(fitl$residuals[i] > 100 | fitb$residuals < -100)
print(paste0("l: ",i))
if(fits$residuals[i] > 100 | fitb$residuals < -100)
print(paste0("s: ",i))
if(fitc$residuals[i] > 100 | fitb$residuals < -100)
print(paste0("c: ",i))
}
for(i in (1:88)){
if(fitb$residuals[i] > 100 | fitb$residuals < -100)
print(paste0("b: ",i))
if(fitl$residuals[i] > 100 | fitb$residuals < -100)
print(paste0("l: ",i))
if(fits$residuals[i] > 100 | fitb$residuals < -100)
print(paste0("s: ",i))
if(fitc$residuals[i] > 100 | fitb$residuals < -100)
print(paste0("c: ",i))
}
